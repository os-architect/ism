services:
    api:
        image: openjdk:11.0.5-stretch
        volumes:
            - .:/app

    kafka:
        image: wurstmeister/kafka
        ports:
            - "9092:9092"
        environment:
            KAFKA_ADVERTISED_HOST_NAME: localhost
            KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181

    ember: &defaults
        image: danlynn/ember-cli:3.7.1
        volumes:
            - ./watcher:/myapp

    npm:
        <<: *defaults
        command: npm install

    bower:
        <<: *defaults
        command: bower install --allow-root

    server:
        <<: *defaults
        command: ember serve --watcher polling
        ports:
            - "4200:4200"
            - "7020:7020"
            - "7357:7357"
